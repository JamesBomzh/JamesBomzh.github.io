<!DOCTYPE html>
<html lang="ru-RU">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="style.css"/>
    <title>Многофайловые программы и Заголовочные файлы</title>
</head>

<body>
<div class="t_menu">
    <ol class="t_ol">
        <li class="t_li">
            <a href="index.html">Введение в языки программирования C и С++</a>
        </li>
        <li class="t_li">
            <a href="structure.html">Структура программ</a>
        </li>
        <li class="t_li">
            <a href="variables.html">Переменные, Инициализация и Присваивание</a>
        </li>
        <li class="t_li">
            <a href="cout_cin.html">cout, cin и endl</a>
        </li>
        <li class="t_li">
            <a href="functions.html">Функции и оператор возврата return</a>
        </li>
        <li class="t_li">
            <a href="parameters.html">Параметры и аргументы функций</a>
        </li>
        <li class="t_li">
            <a href="key_words.html">Ключевые слова и идентификаторы</a>
        </li>
        <li class="t_li">
            <a href="operators.html">Операторы</a>
        </li>
        <li class="t_li">
            <a href="prototypes.html">Прототип функции и Предварительное объявление</a>
        </li>
        <li class="t_li">
            <a href="headers.html">Многофайловые программы и заголовочные файлы</a>
            <ol class="t_ol">
                <li class="t_li"><a href="#vs">Многофайловые проекты в Visual Studio</a></li>
                <li class="t_li"><a href="#example">Пример многофайловой программы</a></li>
                <li class="t_li"><a href="#standard_headers">Заголовочные файлы из Стандартной библиотеки C++</a></li>
                <li class="t_li"><a href="#your_headers">Пишем свои собственные заголовочные файлы</a></li>
                <li class="t_li"><a href="#brackets_vs_quotes">Угловые скобки (<>) vs. Двойные кавычки ("")</a></li>
                <li class="t_li"><a href="#why_iostream">Почему iostream пишется без окончания .h?</a></li>
            </ol>
        </li>
        <li class="t_li">
            <a href="pragma.html">Header guards и #pragma once</a>
        </li>
        <li class="t_li">
            <a href="namespaces_conflict.html">Конфликт имен и std namespace</a>
        </li>
        <li class="t_li">
            <a href="test.html">Итоговый тест</a>
        </li>
    </ol>
</div>

<div class="page_style">
    <h1>Многофайловые программы и Заголовочные файлы</h1>
    <h2 id="vs">Многофайловые проекты в Visual Studio</h2>
    <div>
        <p>В Visual Studio щелкните правой кнопкой мыши по имени вашего проекта в <i>"Обозревателе решений"</i>, затем
            <i>"Добавить" > "Создать элемент..."</i>:</p>
        <div class="img">
            <img src="img/10/1.jpg" alt="1"/>
        </div>
        <p>Во всплывающем диалоговом окне выберите тип файла, укажите его имя, расположение, а затем нажмите <i>"Добавить"</i>:
        </p>
        <div class="img">
            <img src="img/10/2.jpg" alt="2"/>
        </div>
        <p>Также вы можете добавлять файлы к вашему проекту через <i>"Проект" > "Добавить новый элемент..."</i>:</p>
        <div class="img">
            <img src="img/10/3.jpg" alt="3"/>
        </div>
    </div>

    <h2 id="example">Пример многофайловой программы</h2>
    <div>
        <p>Рассмотрим следующую программу, которая состоит из двух файлов.</p>
        <p>add.cpp:</p>
        <div class="img">
            <img src="img/10/4.png" alt="4"/>
        </div>
        <p>main.cpp:</p>
        <div class="img">
            <img src="img/10/5.png" alt="5"/>
        </div>
        <p>Попробуйте запустить эту программу. Она не скомпилируется, вы получите следующую ошибку:</p>
        <p><i>add: идентификатор не найден</i></p>
        <p>При компиляции кода, компилятор не знает о существовании функций, которые находятся в других файлах. Это
            сделано специально, чтобы функции и переменные с одинаковыми именами, но в разных файлах, не вызывали
            конфликт имен.</p>
        <p>Тем не менее, в данном случае, мы хотим, чтобы main.cpp знал (и использовал) функцию аdd(), которая находится
            в add.cpp. Для предоставления доступа main.cpp к функциям add.cpp, нам нужно использовать предварительное
            объявление:</p>
        <div class="img">
            <img src="img/10/6.png" alt="6"/>
        </div>
        <p>Теперь, когда компилятор будет компилировать main.cpp, он будет знать, что такое add(). Попробуйте запустить
            эту программу еще раз.</p>
    </div>

    <h2 id="standard_headers">Заголовочные файлы из Стандартной библиотеки C++</h2>
    <div>
        <p>Рассмотрим следующую программу:</p>
        <div class="img">
            <img src="img/10/7.png" alt="7"/>
        </div>
        <p>Результат выполнения программы:</p>
        <p><i>Hello, world!</i></p>
        <p>В этой программе мы используем cout, который нигде не определяем. Откуда компилятор знает, что это такое?
            Дело в том, что cout объявлен в заголовочном файле iostream. Когда мы пишем <i>#include < iostream ></i>, мы
            делаем запрос, чтобы всё содержимое заголовочного файла iostream было скопировано в наш файл. Таким образом,
            всё содержимое библиотеки iostream становится доступным для использования.</p>
        <p>Как правило, в заголовочных файлах записываются только объявления, без определений. Следовательно, если cout
            только объявлен в заголовочном файле iostream, то где же он определяется? Ответ: в Стандартной библиотеке
            С++, которая автоматически подключается к вашему проекту на этапе линкинга.</p>
        <div class="img">
            <img src="img/10/8.jpg" alt="8"/>
        </div>
    </div>

    <h2 id="your_headers">Пишем свои собственные заголовочные файлы</h2>
    <div>
        <p>Теперь давайте вернемся к примеру, который мы обсуждали на предыдущем уроке. У нас было два файла: add.cpp и
            main.cpp.</p>
        <p>add.cpp:</p>
        <div class="img">
            <img src="img/10/9.png" alt="9"/>
        </div>
        <p>main.cpp:</p>
        <div class="img">
            <img src="img/10/10.png" alt="10"/>
        </div>
        <p class="attention">Если вы создаете все файлы заново, то не забудьте добавить add.cpp в свой проект, чтобы он
            был подключен к компиляции.</p>
        <p>Мы использовали предварительное объявление, чтобы сообщить компилятору, что такое add(). Как мы уже говорили,
            записывать в каждом файле предварительные объявления используемых функций — дело не слишком
            увлекательное.</p>
        <p>И здесь нам на помощь приходят заголовочные файлы. Достаточно просто написать один заголовочный файл и его
            можно будет повторно использовать в любом количестве программ. Также и вносить изменения в такой код
            (например, добавление еще одного параметра) гораздо легче, нежели чем шерстить по всем файлам в поисках
            используемых функций.</p>
        <p>Написать свой собственный заголовочный файл не так уж и сложно. Заголовочные файлы состоят из двух
            частей:</p>
        <ul>
            <li><b>Директивы препроцессора</b> — в частности, header guards, которые предотвращают вызов заголовочного
                файла больше одного раза из одного и того же файла.
            </li>
            <li><b>Содержимое заголовочного файла</b> — набор объявлений.</li>
        </ul>
        <p>Все ваши заголовочные файлы (которые вы написали самостоятельно) должны иметь расширение <i>.h</i>.</p>
        <p>add.h:</p>
        <div class="img">
            <img src="img/10/11.png" alt="11"/>
        </div>
        <p>Чтобы использовать этот файл в main.cpp, вам сначала нужно будет подключить его к проекту.</p>
        <p>main.cpp, в котором мы подключаем add.h:</p>
        <div class="img">
            <img src="img/10/12.png" alt="12"/>
        </div>
        <p>add.cpp остается без изменений:</p>
        <div class="img">
            <img src="img/10/9.png" alt="9"/>
        </div>
        <p>Когда компилятор встречает <i>#include "add.h"</i>, он копирует всё содержимое add.h в текущий файл. Таким
            образом, мы получаем предварительное объявление функции add().</p>
        <p class="attention">Примечание: При подключении заголовочного файла, всё его содержимое вставляется сразу же
            после строки #include ....</p>
        <p>Если вы получили ошибку от компилятора, что add.h не найден, то убедитесь, что имя вашего файла точно
            «add.h». Вполне возможно, что вы могли сделать опечатку, например, просто «add» (без «.h») или «add.h.txt»
            или «add.hpp».</p>
        <p>Если вы получили ошибку от линкера, что функция аdd() не определена, то убедитесь, что вы корректно
            подключили add.cpp к вашему проекту (и к компиляции тоже)!</p>
    </div>

    <h2 id="brackets_vs_quotes">Угловые скобки (<>) vs. Двойные кавычки ("")</h2>
    <div>
        <p>Вы, наверное, хотите узнать, почему используются угловые скобки для iostream и двойные кавычки для add.h.
            Дело в том, что, используя угловые скобки, мы сообщаем компилятору, что подключаемый заголовочный файл
            написан не нами (он является «системным», т.е. предоставляется Стандартной библиотекой С++), так что искать
            этот заголовочный файл следует в системных директориях. Двойные кавычки сообщают компилятору, что мы
            подключаем наш собственный заголовочный файл, который мы написали самостоятельно, поэтому искать его следует
            в текущей директории нашего проекта. Если файла там не окажется, то компилятор начнет проверять другие пути,
            в том числе и системные директории.</p>
        <p class="attention">Используйте угловые скобки для подключения «системных» заголовочных файлов и двойные
            кавычки для ваших заголовочных файлов.</p>
        <p>Стоит отметить, что одни заголовочные файлы могут подключать другие заголовочные файлы. Тем не менее, так
            делать не рекомендуется.</p>
    </div>

    <h2 id="why_iostream">Почему iostream пишется без окончания .h?</h2>
    <div>
        <p>Еще один часто задаваемый вопрос: «Почему iostream (или любой другой из стандартных заголовочных файлов) при
            подключении пишется без окончания «.h»?». Дело в том, что есть 2 отдельных файла: iostream.h (заголовочный
            файл) и просто iostream! Для объяснения потребуется краткий экскурс в историю.</p>
        <p>Когда C++ только создавался, все файлы библиотеки Runtime имели окончание .h. Оригинальные версии cout и cin
            объявлены в iostream.h. При стандартизации языка С++ комитетом ANSI, решили перенести все функции из
            библиотеки Runtime в пространствo имен std, чтобы предотвратить возможность возникновения конфликтов имен с
            пользовательскими идентификаторами (что, между прочим, является хорошей идеей). Тем не менее, возникла
            проблема: если все функции переместить в пространство имен std, то старые программы переставали
            работать!</p>
        <p>Для обеспечения обратной совместимости ввели новый набор заголовочных файлов с теми же именами, но без
            окончания «.h». Весь их функционал находится в пространстве имен std. Таким образом, старые программы с
            #include < iostream.h > не нужно было переписывать, а новые программы уже могли использовать #include <
            iostream >.</p>
        <p>Когда вы подключаете заголовочный файл из Стандартной библиотеки C++, убедитесь, что вы используете версию
            без .h (если она существует). В противном случае, вы будете использовать устаревшую версию заголовочного
            файла, который уже больше не поддерживается.</p>
        <p>Кроме того, многие библиотеки, унаследованные от языка Cи, которые до сих пор используются в C++, также были
            продублированы с добавлением префикса c (например, stdlib.h стал cstdlib). Функционал этих библиотек также
            перенесли в пространство имен std, чтобы избежать возможность возникновения конфликтов имен с
            пользовательскими идентификаторами.</p>
        <p class="attention">При подключении заголовочных файлов из Стандартной библиотеки С++, используйте версию без
            «.h» (если она существует). Пользовательские заголовочные файлы должны иметь окончание «.h».</p>
    </div>

    <button style="display: inline-block; float: right;" onclick="document.location='pragma.html'">Следующий урок
    </button>
    <button style="display: inline-block; float: left;" onclick="document.location='prototypes.html'">Предыдущий урок
    </button>
</div>
</body>
</html>