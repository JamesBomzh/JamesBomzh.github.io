<!DOCTYPE html>
<html lang="ru-RU">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="style.css"/>
    <title>Прототип функции и Предварительное объявление</title>
</head>

<body>
<div class="t_menu">
    <ol class="t_ol">
        <li class="t_li">
            <a href="index.html">Введение в языки программирования C и С++</a>
        </li>
        <li class="t_li">
            <a href="structure.html">Структура программ</a>
        </li>
        <li class="t_li">
            <a href="variables.html">Переменные, Инициализация и Присваивание</a>
        </li>
        <li class="t_li">
            <a href="cout_cin.html">cout, cin и endl</a>
        </li>
        <li class="t_li">
            <a href="functions.html">Функции и оператор возврата return</a>
        </li>
        <li class="t_li">
            <a href="parameters.html">Параметры и аргументы функций</a>
        </li>
        <li class="t_li">
            <a href="key_words.html">Ключевые слова и идентификаторы</a>
        </li>
        <li class="t_li">
            <a href="operators.html">Операторы</a>
        </li>
        <li class="t_li">
            <a href="prototypes.html">Прототип функции и Предварительное объявление</a>
            <ol class="t_ol">
                <li class="t_li"><a href="#problem">Наличие проблемы</a></li>
                <li class="t_li"><a href="#prots">Прототипы функций и Предварительное объявление</a></li>
                <li class="t_li"><a href="#not_defined">Предварительно объявили, но не определили</a></li>
                <li class="t_li"><a href="#decl_vs_def">Объявление vs. Определение</a></li>
            </ol>
        </li>
        <li class="t_li">
            <a href="headers.html">Многофайловые программы и заголовочные файлы</a>
        </li>
        <li class="t_li">
            <a href="pragma.html">Header guards и #pragma once</a>
        </li>
        <li class="t_li">
            <a href="namespaces_conflict.html">Конфликт имен и std namespace</a>
        </li>
        <li class="t_li">
            <a href="test.html">Итоговый тест</a>
        </li>
    </ol>
</div>

<div class="page_style">
    <h1>Прототип функции и Предварительное объявление</h1>
    <h2 id="problem">Наличие проблемы</h2>
    <div>
        <p>Посмотрите на этот, казалось бы, невинный кусочек кода под названием add.cpp:</p>
        <div class="img">
            <img src="img/9/prot1.png" alt="prot1"/>
        </div>
        <p>Вы, наверное, ожидаете увидеть примерно следующий результат:</p>
        <p><i>The sum of 3 and 4 is: 7</i></p>
        <p>Но в действительности эта программа даже не скомпилируется. Причиной этому является то, что компилятор читает
            код последовательно. Когда он встречает вызов функции add() в строке №5 функции main(), он даже не знает,
            что такое add(), так как это еще не определили! В результате чего мы получим следующую ошибку:</p>
        <p><i>add: идентификатор не найден</i></p>
        <p>Чтобы устранить эту проблему, мы должны учитывать тот факт, что компилятор не знает, что такое add(). Есть 2
            решения.</p>
        <p><b>Решение №1</b>: Поместить определение функции add() выше её вызова (т.е. перед функцией main()):</p>
        <div class="img">
            <img src="img/9/prot2.png" alt="prot2"/>
        </div>
        <p>Таким образом, при вызове функции add() в функции main(), компилятор будет знать, что это такое. Так как это
            простая программа, то внести подобные изменения несложно. Однако в программах, содержащих большое количество
            строк кода, это может быть утомительно — узнавать кто кого вызывает и в каком порядке (чтобы соблюсти
            правильную последовательность).</p>
        <p>Кроме того, этот вариант не всегда возможен. Например, мы пишем программу, которая имеет две функции: А() и
            В(). Если функция А() вызывает функцию В(), а функция В() вызывает функцию А(), то нет никакого способа
            упорядочить эти функции таким образом, чтобы они обе одновременно знали о существовании друг друга. Если вы
            объявите сначала А(), то компилятор будет жаловаться, что не знает, что такое В(). Если вы объявите сначала
            В(), то компилятор будет жаловаться, что не знает, что такое А().</p>
    </div>

    <h2 id="prots">Прототипы функций и Предварительное объявление</h2>
    <div>
        <p><b>Решение №2</b>: Использовать предварительное объявление.</p>
        <p><b>Предварительное объявление</b> сообщает компилятору о существовании идентификатора ДО его фактического
            определения.</p>
        <p>В случае функций, мы можем сообщить компилятору о существовании функции до её фактического определения. Для
            этого нам следует использовать прототип этой функции. <b>Прототип функции</b> (полноценный) состоит из типа
            возврата функции, её имени и параметров (тип + имя параметра). В кратком прототипе отсутствуют имена
            параметров функции. Основная часть (между фигурными скобками) опускается. А поскольку прототип функции
            является стейтментом, то он также заканчивается точкой с запятой.</p>
        <p>Вот прототип функции add():</p>
        <div class="img">
            <img src="img/9/prot3.png" alt="prot3"/>
        </div>
        <p>А вот вышеприведенная программа, но уже с прототипом функции в качестве предварительного объявления
            аdd():</p>
        <div class="img">
            <img src="img/9/prot4.png" alt="prot4"/>
        </div>
        <p>Теперь, когда компилятор встречает вызов функции add() в main(), он знает, что это такое и где это
            искать.</p>
        <p>Стоит отметить, что в прототипах функций можно и не указывать имена параметров. Тем не менее,
            предпочтительнее указывать имена параметров, чтобы не путаться лишний раз.</p>
        <p class="attention">Прототипы функций можно легко создавать с помощью копирования/вставки из фактического
            определения функции. Просто не забывайте указывать точку с запятой в конце.</p>
    </div>

    <h2 id="not_defined">Предварительно объявили, но не определили</h2>
    <div>
        <p>Вопрос: «А что произойдет, если мы предварительно объявим функцию, но не запишем её определение?».
            Однозначного ответа нет. Если предварительное объявление записано, но функция никогда не вызывается, то
            программа может запуститься без ошибок. Однако, если предварительное объявление записано, функция
            вызывается, но её определения нет, то вы получите ошибку на этапе линкинга: программа просто не сможет
            обработать вызов этой функции.</p>
        <p>Рассмотрим следующую программу:</p>
        <div class="img">
            <img src="img/9/prot5.png" alt="prot5"/>
        </div>
        <p>В этой программе мы предварительно объявили функцию add(), вызвали её в main(), но не записали её
            определения. При попытке компиляции этой программы мы получим ошибку от линкера.</p>
    </div>

    <h2 id="decl_vs_def">Объявление vs. Определение</h2>
    <div>
        <p>В языке C++ вы часто будете слышать слова «объявление» и «определение». Что это такое?</p>
        <p><b>Определение</b> фактически реализует (вызывает выделение памяти) идентификатор. Вот примеры определений:
        </p>
        <div class="img">
            <img src="img/9/prot6.png" alt="prot6"/>
        </div>
        <p>Определение необходимо для корректной работы линкера. Если вы используете идентификатор без его определения,
            то линкер выдаст вам ошибку.</p>
        <p>В языке C++ есть правило одного определения, которое состоит из трех частей:</p>
        <ul>
            <li>Внутри файла функция, объект, тип или шаблон могут иметь только одно определение.</li>
            <li>Внутри программы объект или обычная функция могут иметь только одно определение.</li>
            <li>Внутри программы типы, шаблоны функций и встроенные функции могут иметь несколько определений, если они
                идентичны.
            </li>
        </ul>
        <p>Нарушение первой части правила приведет к ошибке компиляции. Нарушение второй или третьей части правила
            приведет к ошибке линкинга.</p>
        <p><b>Объявление</b> — это стейтмент, который сообщает компилятору о существовании идентификатора и о его типе.
            Вот примеры объявлений:</p>
        <div class="img">
            <img src="img/9/prot7.png" alt="prot7"/>
        </div>
        <p>Объявление — это всё, что необходимо для корректной работы компилятора, но недостаточно для корректной работы
            линкера. Определение — это то, что обеспечит корректную работу как компилятора, так и линкера.</p>
    </div>

    <button style="display: inline-block; float: right;" onclick="document.location='headers.html'">Следующий урок
    </button>
    <button style="display: inline-block; float: left;" onclick="document.location='operators.html'">Предыдущий урок
    </button>
</div>
</body>
</html>